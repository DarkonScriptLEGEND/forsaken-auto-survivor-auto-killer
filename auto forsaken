-- Forsaken Auto Survivor AI Script (Noob Role)
local Players, RunService, Workspace = game:GetService("Players"), game:GetService("RunService"), game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer

-- SETTINGS
local ESP_ENABLED = true
local MAX_STAMINA = 100
local STAMINA_THRESHOLD = 25
local WALK_SPEED = 16
local SPRINT_SPEED = 24
local REST_TIME = 3

-- GUI Setup
local screenGui = Instance.new("ScreenGui", game.CoreGui)
local button = Instance.new("TextButton", screenGui)
button.Size = UDim2.new(0, 180, 0, 40)
button.Position = UDim2.new(0, 10, 0, 10)
button.Text = "Auto Survivor: OFF"
button.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
button.TextColor3 = Color3.fromRGB(255, 255, 255)

-- ESP Function
local function createESP(target)
    if not ESP_ENABLED then return end
    if target:FindFirstChild("Highlight") then return end
    local highlight = Instance.new("Highlight", target)
    highlight.FillColor = Color3.fromRGB(255, 0, 0)
    highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
    highlight.Name = "Highlight"
end

-- Killer Detection
local function getKiller()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local tag = player:FindFirstChild("Role") or player:FindFirstChild("Tag")
            if tag and tostring(tag.Value):lower():find("killer") then
                createESP(player.Character)
                return player
            end
        end
    end
end

-- Generator Detection
local function getNearestGenerator()
    local minDist, nearest = math.huge, nil
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj.Name:lower():find("generator") and obj:IsA("BasePart") then
            local dist = (obj.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
            if dist < minDist then
                minDist, nearest = dist, obj
            end
        end
    end
    return nearest
end

-- AI Logic
local autoOn = false
local function runAI()
    task.spawn(function()
        while autoOn and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") do
            local char = LocalPlayer.Character
            local humanoid = char:FindFirstChildOfClass("Humanoid")
            local hrp = char:FindFirstChild("HumanoidRootPart")
            local stamina = MAX_STAMINA

            local killer = getKiller()
            if killer and killer.Character and killer.Character:FindFirstChild("HumanoidRootPart") then
                local dist = (killer.Character.HumanoidRootPart.Position - hrp.Position).Magnitude
                if dist < 45 then
                    humanoid.WalkSpeed = SPRINT_SPEED
                    local runDirection = (hrp.Position - killer.Character.HumanoidRootPart.Position).Unit
                    hrp.CFrame = hrp.CFrame + runDirection * 2
                    stamina = stamina - 5
                elseif dist < 85 then
                    humanoid.WalkSpeed = WALK_SPEED
                    local runDirection = (hrp.Position - killer.Character.HumanoidRootPart.Position).Unit
                    hrp.CFrame = hrp.CFrame + runDirection * 1.5
                    stamina = stamina - 2
                end
            end

            -- Generator Repair (if safe)
            local generator = getNearestGenerator()
            if generator and not killer then
                local dist = (generator.Position - hrp.Position).Magnitude
                if dist > 5 then
                    local dir = (generator.Position - hrp.Position).Unit
                    hrp.CFrame = hrp.CFrame + dir * 1
                end
            end

            -- Stamina Management
            if stamina <= STAMINA_THRESHOLD then
                humanoid.WalkSpeed = 0
                wait(REST_TIME)
                stamina = MAX_STAMINA
            end

            task.wait(0.3)
        end
    end)
end

-- Button Toggle
button.MouseButton1Click:Connect(function()
    autoOn = not autoOn
    button.Text = autoOn and "Auto Survivor: ON" or "Auto Survivor: OFF"
    if autoOn then runAI() end
end)
