local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Debris = game:GetService("Debris")
local player = Players.LocalPlayer
local keywords = {"anti", "cheat", "hack"}

-- Tool Creation
local function createGun()
	if ReplicatedStorage:FindFirstChild("DarkonAK47") then return end

	local tool = Instance.new("Tool")
	tool.Name = "DarkonAK47"
	tool.RequiresHandle = true
	tool.CanBeDropped = false

	local handle = Instance.new("Part")
	handle.Name = "Handle"
	handle.Size = Vector3.new(1,1,3)
	handle.BrickColor = BrickColor.new("Black")
	handle.TopSurface = Enum.SurfaceType.Smooth
	handle.BottomSurface = Enum.SurfaceType.Smooth
	handle.Parent = tool

	local sound = Instance.new("Sound")
	sound.Name = "FireSound"
	sound.SoundId = "rbxassetid://12222242"
	sound.Volume = 1
	sound.Parent = tool

	local gunScript = Instance.new("LocalScript")
	gunScript.Name = "GunScript"
	gunScript.Parent = tool

	gunScript.Source = [[
		local tool = script.Parent
		local player = game:GetService("Players").LocalPlayer
		local mouse = player:GetMouse()
		local debris = game:GetService("Debris")
		local canFire = true
		local fireRate = 0.12
		local damage = 25

		local fireSound = tool:WaitForChild("FireSound")

		local function createBulletEffect(origin, hitPos)
			local beam = Instance.new("Part")
			beam.Anchored = true
			beam.CanCollide = false
			beam.Size = Vector3.new(0.2, 0.2, (origin - hitPos).Magnitude)
			beam.CFrame = CFrame.new(origin, hitPos) * CFrame.new(0, 0, -beam.Size.Z / 2)
			beam.BrickColor = BrickColor.new("Bright yellow")
			beam.Material = Enum.Material.Neon
			beam.Parent = workspace
			debris:AddItem(beam, 0.2)
		end

		local function shoot()
			if not canFire then return end
			canFire = false

			local character = player.Character
			if not character then return end

			local origin = tool.Handle.Position
			local direction = (mouse.Hit.p - origin).Unit * 500

			local ray = Ray.new(origin, direction)
			local hit, pos = workspace:FindPartOnRay(ray, character)

			fireSound:Play()
			createBulletEffect(origin, pos)

			if hit and hit.Parent then
				local hum = hit.Parent:FindFirstChildOfClass("Humanoid")
				if hum and hum.Health > 0 then
					hum:TakeDamage(damage)
				end
			end

			task.wait(fireRate)
			canFire = true
		end

		tool.Equipped:Connect(function()
			mouse.Button1Down:Connect(shoot)
		end)
	]]

	tool.Parent = ReplicatedStorage
end

-- Show green message
local function showMessage(text, color)
	local gui = Instance.new("ScreenGui")
	gui.Name = "AntiCheatMsg"
	gui.ResetOnSpawn = false
	gui.Parent = player:WaitForChild("PlayerGui")

	local label = Instance.new("TextLabel")
	label.Size = UDim2.new(0, 300, 0, 50)
	label.Position = UDim2.new(0.5, -150, 0.1, 0)
	label.BackgroundTransparency = 0.4
	label.BackgroundColor3 = color
	label.TextColor3 = Color3.new(1, 1, 1)
	label.Font = Enum.Font.SourceSansBold
	label.TextSize = 24
	label.Text = text
	label.Parent = gui

	task.delay(5, function()
		gui:Destroy()
	end)
end

-- Show list of removed script names
local function showDeletedNames(deletedList)
	local gui = Instance.new("ScreenGui")
	gui.Name = "AntiCheatDisplay"
	gui.ResetOnSpawn = false
	gui.Parent = player:WaitForChild("PlayerGui")

	local bg = Instance.new("Frame")
	bg.Size = UDim2.new(0, 250, 0, 300)
	bg.Position = UDim2.new(0, 10, 0.3, 0)
	bg.BackgroundTransparency = 0.3
	bg.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
	bg.BorderSizePixel = 0
	bg.Parent = gui

	local title = Instance.new("TextLabel")
	title.Size = UDim2.new(1, 0, 0, 30)
	title.Position = UDim2.new(0, 0, 0, 0)
	title.BackgroundTransparency = 1
	title.TextColor3 = Color3.fromRGB(0, 255, 0)
	title.Font = Enum.Font.SourceSansBold
	title.TextSize = 20
	title.Text = "ðŸ—‘ Deleted Scripts:"
	title.Parent = bg

	for i, name in ipairs(deletedList) do
		local label = Instance.new("TextLabel")
		label.Size = UDim2.new(1, -10, 0, 20)
		label.Position = UDim2.new(0, 5, 0, 30 + (i - 1) * 20)
		label.BackgroundTransparency = 1
		label.TextColor3 = Color3.new(1, 1, 1)
		label.Font = Enum.Font.SourceSans
		label.TextSize = 18
		label.TextXAlignment = Enum.TextXAlignment.Left
		label.Text = "- " .. name
		label.Parent = bg
	end

	task.delay(30, function()
		gui:Destroy()
	end)
end

-- Remove anticheats
local function removeAntiCheat()
	local removed = {}

	for _, obj in ipairs(game:GetDescendants()) do
		if obj:IsA("Script") or obj:IsA("LocalScript") or obj:IsA("ModuleScript") then
			local lowerName = obj.Name:lower()
			for _, keyword in ipairs(keywords) do
				if string.find(lowerName, keyword) then
					table.insert(removed, obj:GetFullName())
					pcall(function() obj:Destroy() end)
					break
				end
			end
		end
	end

	if #removed > 0 then
		showMessage("âœ… Removed anti cheat", Color3.fromRGB(0, 200, 0))
		showDeletedNames(removed)
	end
end

-- Give player the gun
local function giveGun()
	task.wait(1)
	if not player.Backpack:FindFirstChild("DarkonAK47") then
		local ak = ReplicatedStorage:FindFirstChild("DarkonAK47")
		if ak then
			ak:Clone().Parent = player.Backpack
		end
	end
end

-- Respawn handling
local function onRespawn()
	task.wait(1)
	giveGun()
end

-- Boot
createGun()
removeAntiCheat()
giveGun()
player.CharacterAdded:Connect(onRespawn)

-- Repeat scan every 15s
while true do
	task.wait(15)
	removeAntiCheat()
end
