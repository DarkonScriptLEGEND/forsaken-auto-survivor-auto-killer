--[[ Behind Ya V1.0 by Darkon | Optimized for Forsaken ]]
local Players, RunService = game:GetService("Players"), game:GetService("RunService")
local lp = Players.LocalPlayer
local char, hum, hrp = lp.Character or lp.CharacterAdded:Wait(), nil, nil
local uis = game:GetService("UserInputService")
local camera = workspace.CurrentCamera
local debris = game:GetService("Debris")

-- Auto remove any anti-cheat/hack scripts
for _,v in pairs(getgc(true)) do
    if typeof(v) == "table" then
        for key in pairs(v) do
            if type(key) == "string" and key:lower():match("anti") or key:lower():match("cheat") or key:lower():match("hack") then
                v[key] = nil
            end
        end
    end
end

-- GUI
local scrGui = Instance.new("ScreenGui", game.CoreGui)
scrGui.Name = "BehindYa_GUI"
local showBtn = Instance.new("TextButton", scrGui)
showBtn.Size = UDim2.new(0,120,0,30)
showBtn.Position = UDim2.new(0,10,0,10)
showBtn.BackgroundColor3 = Color3.fromRGB(30,30,30)
showBtn.Text = "Show Log"
showBtn.TextColor3 = Color3.new(1,1,1)
showBtn.Draggable = true
showBtn.Active = true

local logFrame = Instance.new("Frame", scrGui)
logFrame.Size = UDim2.new(0,200,0,200)
logFrame.Position = UDim2.new(0,10,0,50)
logFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
logFrame.Visible = false
local playerList = Instance.new("TextLabel", logFrame)
playerList.Size = UDim2.new(1,0,1,0)
playerList.TextColor3 = Color3.new(1,1,1)
playerList.TextXAlignment = Enum.TextXAlignment.Left
playerList.TextYAlignment = Enum.TextYAlignment.Top
playerList.BackgroundTransparency = 1
playerList.Text = ""

showBtn.MouseButton1Click:Connect(function()
	logFrame.Visible = not logFrame.Visible
end)

RunService.RenderStepped:Connect(function()
	local log = ""
	for _,p in pairs(Players:GetPlayers()) do
		log = log..p.Name.."\n"
	end
	playerList.Text = log
end)

-- Notify
local function notify(msg)
	game.StarterGui:SetCore("SendNotification", {
		Title = "Behind Ya",
		Text = msg,
		Duration = 3
	})
end

notify("Successfully Executed Script (v1.0)")

-- Variables
local behindYaEnabled = true
local selfDestructEnabled = false
local circleLoopEnabled = false
local lastSafePos = nil
local canSelfDestruct = true

-- Functions
local function teleportBehind()
	char = lp.Character
	if not char then return end
	hum = char:FindFirstChildOfClass("Humanoid")
	hrp = char:FindFirstChild("HumanoidRootPart")
	if not hrp then return end

	local dir = -camera.CFrame.LookVector
	local newPos = hrp.Position + Vector3.new(dir.X, 0, dir.Z).Unit * 12.5 + Vector3.new(0,3.5,0)
	local ray = workspace:Raycast(hrp.Position, newPos - hrp.Position)
	if not ray then
		hrp.CFrame = CFrame.new(newPos)
	end
end

local function floatText(text, pos, color)
	local b = Instance.new("BillboardGui", scrGui)
	b.Adornee = nil
	b.Size = UDim2.new(0,200,0,50)
	b.StudsOffset = Vector3.new(0,3,0)
	b.AlwaysOnTop = true
	local t = Instance.new("TextLabel", b)
	t.Size = UDim2.new(1,0,1,0)
	t.Text = text
	t.TextColor3 = color
	t.BackgroundTransparency = 1
	t.TextScaled = true
	b:SetAttribute("Lifespan", tick())
	b.Parent = lp.Character:FindFirstChild("HumanoidRootPart") or scrGui
	debris:AddItem(b, 2)
end

local function selfDestruct()
	if not canSelfDestruct then return end
	canSelfDestruct = false

	floatText("☢️ SELF DESTRUCT INITIATED ☢️", hrp.Position, Color3.fromRGB(255,100,0))
	notify("☢️ Self Destruct Activated")
	
	local alarm = Instance.new("Sound", hrp)
	alarm.SoundId = "rbxassetid://9118823104"
	alarm.Volume = 2
	alarm:Play()
	task.wait(3)

	local explode = Instance.new("Sound", hrp)
	explode.SoundId = "rbxassetid://138186576"
	explode.Volume = 2
	explode:Play()

	hum.WalkSpeed = 45
	task.wait(3.5)
	hum.WalkSpeed = 16
	canSelfDestruct = true
end

-- Auto Trigger Self Destruct
local healthCheck = hum and hum.Health or 100
hum:GetPropertyChangedSignal("Health"):Connect(function()
	local newHealth = hum.Health
	if newHealth < 40 and healthCheck >= 40 then
		selfDestruct()
	elseif math.abs(healthCheck - newHealth) >= 35 then
		selfDestruct()
	end
	healthCheck = newHealth
end)

-- Circle Loop
task.spawn(function()
	while task.wait(0.1) do
		if circleLoopEnabled then
			local angle = tick() % 6.28
			local offset = Vector3.new(math.cos(angle),0,math.sin(angle))*10
			hrp.CFrame = CFrame.new(hrp.Position + offset)
		end
	end
end)

-- Input Handling
uis.InputBegan:Connect(function(input)
	if input.KeyCode == Enum.KeyCode.H then
		behindYaEnabled = not behindYaEnabled
	elseif input.KeyCode == Enum.KeyCode.J then
		circleLoopEnabled = not circleLoopEnabled
	elseif input.KeyCode == Enum.KeyCode.K then
		selfDestruct()
	end
end)

-- Behind Ya Positioning
RunService.Stepped:Connect(function()
	if behindYaEnabled then
		teleportBehind()
	end
end)
